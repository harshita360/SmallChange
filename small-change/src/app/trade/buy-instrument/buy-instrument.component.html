<div class="card mt-3">
  <div class="card-header">
    <div class="container">
      <h3 class="card-title">Buy Instrument</h3>
    </div>
  </div>
  <div class="card-body">
    <form  [formGroup]="buyInstrumentForm" class="container">
      <div class="row mb-3">
        <label class="col-12 col-md-4 form-label" for="floatingInput">Select Account: </label>
        <div class="col-12 col-md">
          <select formControlName="portfolioId"  class="form-select form-select-md mb-3" aria-label=".form-select-lg example">
            <option *ngFor="let account of portfolios" value="{{account.id}}">{{account.name}}</option>
          </select>
          <div class="error-text" *ngIf="errorMessage['portfolioId']">
            {{errorMessage['portfolioId']}}
          </div>
        </div>
        <div class="row mb-3" *ngIf="currentPortfolio">
          <label class="col-8 form-label">Balance in your account</label> {{currentPortfolio.balance | currency:'USD'}}
        </div>
        <div class="row mb-3">
          <label class="col-12 col-md-4 form-label">Instrument Category: </label>
          <div class="col-12 col-md">
            <select formControlName="instrumentCategoryId" class="form-select form-select-md mb-3" aria-label=".form-select-md example" [ngClass]="{ 'invalid-form-control': errorMessage['instrumentCategoryId'] }">
              <option  *ngFor="let category of categories" [value]="category.categoryId" >{{category.categoryName}}</option>
            </select>
            <div class="error-text" *ngIf="errorMessage['instrumentCategoryId']">
              {{errorMessage['instrumentCategoryId']}}
            </div>
          </div>
        </div>
        <div class="row mb-3">
          <label class="col-12 col-md-4 form-label">Instrument: </label>
          <div class="col-12 col-md">
            <select formControlName="instrumentId" class="form-select form-select-md mb-3" aria-label=".form-select-md example" [ngClass]="{ 'invalid-form-control': errorMessage['instrumentId'] }">
              <option  *ngFor="let instrument of instrumentsOfCategory" [value]="instrument.instrumentId" disabled="{{ checkInstrumentByability(instrument)?'':'disabled' }}" > <app-instrument-detail [type]="'buy'" [instrument]="instrument" ></app-instrument-detail> </option>
            </select>
            <div class="error-text" *ngIf="errorMessage['instrumentId']">
              {{errorMessage['instrumentId']}}
            </div>
          </div>
        </div>
        <div class="row mb-3" *ngIf="selectedInstrument">
          <div class="container" id="instrument-details">
            <div class="row">
              <div class="col-12  col-md-4">
                Instrument Description :
              </div>
              <div class="col-12 col-md">
                {{selectedInstrument.instrument.description}}
              </div>
            </div>
            <div class="row">
              <div class="col-12 col-sm-8 col-md-4">
                Instrument Buy Value :
              </div>
              <div class="col-12 col-sm-4 col-md-2">
                {{selectedInstrument.askPrice | currency:'USD'}}
              </div>
              <div class="col-12 col-sm-8 col-md-4">
                Instrument Sell Value :
              </div>
              <div class="col-12 col-sm-4 col-md-2">
                {{selectedInstrument.bidPrice | currency:'USD'}}
              </div>
            </div>
            <div class="row">
              <div class="col-12 col-sm-8 col-md-4">
                Minimum Quantity :
              </div>
              <div class="col-12 col-sm-4 col-md-2">
                {{selectedInstrument.instrument.minQuantity}}
              </div>
              <div class="col-12 col-sm-8 col-md-4">
                Maximum Quantity :
              </div>
              <div class="col-12 col-sm-4 col-md-2">
                {{selectedInstrument.instrument.maxQuantity}}
              </div>
            </div>
          </div>
        </div>
        <div class="row mb-3">
          <label class="col-12 col-sm-7 col-md-4">Quantity: </label>
          <div class="col-12 col-sm-4 col-md">
            <input formControlName="quantity" type="number" step="1" [attr.min]="selectedInstrument?.instrument?.minQuantity" [attr.max]="maxQuantityCanBuy"   class="form-control" [ngClass]="{ 'invalid-form-control': errorMessage['quantity'] }" id="myRange" aria-describedby="trade-quantity-value">
            <div class="error-text" *ngIf="errorMessage['quantity']">
              {{errorMessage['quantity']}}
            </div>
          </div>
        </div>
        <div class="row mb-1">
          <label class="col-12 col-sm-7 col-md-4">Target Price: </label>
          <div class="col-12 col-sm-4 col-md">
            <input formControlName="targetPrice" type="number" >
          </div>
        </div>
      </div>
    </form>
  </div>
  <div class="card-footer">
    <div class="container-fluid">
      <div class="row">
        <div class="col-12" style="text-align: center;" >
          <button (click)="buyInstrument()" id="buy-trade-link" [disabled]="buyInstrumentForm.invalid || !canFormBeSubmitted" class="btn btn-success" style="margin-right: 10px ;"  >Buy</button>
          <button class="btn btn-danger" style="margin-right: 10px ;"  >Reset</button>
          <button class="btn btn-warning" (click)="goToHome()">Go To Home</button>
        </div>
      </div>
    </div>
  </div>
</div>
<div>
</div>
